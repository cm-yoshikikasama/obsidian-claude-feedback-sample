---
allowed-tools: Bash(cd:*), Bash(date:*), Bash(TZ=:*), Bash(find:*), Write, Read, Glob, LS
argument-hint: [YYYY-MM]
description: デイリーノートからKPT形式の月次振り返りを生成（引数なしで実行月、引数ありで指定月）
---

# KPT形式の月次振り返り生成

## 日付の扱い

- 引数なし: 実行日の月のまとめ（例: 2025-12-26実行時は2025-12）
- 引数1つ（YYYY-MM形式）: 指定月のまとめ（例: 2025-11）
- 対象日付: ${START_DATE} 〜 ${END_DATE}

## 環境変数

```txt
PROJECT_A = "Aプロジェクト"
PROJECT_B = "Bプロジェクト"
PROJECT_C = "Cプロジェクト"
GOAL_1 = "技術力の向上"
GOAL_2 = "プロジェクト管理能力の強化"
GOAL_3 = "コミュニケーション能力の向上"
```

## タスク

完全なレビューを生成するために、以下のステップを順番に実行する

### ステップ0: 対象期間の決定

引数がない場合は実行日の月を使用する。

```bash
if [ -z "$1" ]; then
  # 引数なし: 実行日の月
  TARGET_MONTH=$(date +%Y-%m)
  echo "Generating review for current month: $TARGET_MONTH"
else
  # 引数1つ: 指定された月
  TARGET_MONTH="$1"
  echo "Generating review for: $TARGET_MONTH"
fi

# 開始日と終了日を計算
START_DATE=$(date -j -f "%Y-%m" "$TARGET_MONTH" +%Y-%m-01)
# 終了月の月末を取得
NEXT_MONTH=$(date -j -v+1m -f "%Y-%m" "$TARGET_MONTH" +%Y-%m-01)
END_DATE=$(date -j -v-1d -f "%Y-%m-%d" "$NEXT_MONTH" +%Y-%m-%d)
```

### ステップ1: デイリーノートの検索と読み込み

- 重要: 現在のディレクトリは`.claude/`なので、親ディレクトリから検索する必要がある
- bashコマンド`find ../01_Daily -name "*.md" -type f | sort`を使用してすべてのデイリーノートを検索
- Globツールを使用する場合、`path=".."`パラメータを明示的に指定する必要がある: `Glob(path="..", pattern="01_Daily/**/*.md")`
- 対象の日付範囲（START_DATEからEND_DATE）内のファイルをフィルタリング
- デイリーノートは`01_Daily/YYYY/MM/YYYY-MM-DD.md`のパターンに従う
- 対象期間に該当する各ファイルを読み込む

### ステップ2: 情報の抽出と分析

各デイリーノートから以下を体系的に抽出する

1. MTG・イベント - 完了した会議とイベント（以下の条件を満たす項目）
    - [x]マークがついている
    - かつ、以下のキーワードのいずれかを含む：「定例」「MTG」「会議」「1on1」「○○会」
    - 作業時間ブロック（括弧で始まるプロジェクト作業）は除外
2. 今日のTodo - プロジェクトカテゴリ別のタスクとステータス追跡
    - [ ] 未着手
    - [/] 進行中
    - [R] レビュー中
    - [x] 完了
    - [-] 中止
3. 今日の振り返りセクション（KPT観点で分析）
    - {GOAL_1}の内容から、Keep（うまくいったこと）、Problem（課題）、Try（次に試したいこと）の要素を抽出
    - {GOAL_2}の内容から、Keep、Problem、Tryの要素を抽出
    - {GOAL_3}の内容から、Keep、Problem、Tryの要素を抽出
4. 明日やる - 作成された計画
5. その他の重要なコンテンツや成果

### ステップ3: 事実ベースの集約と分析（KPT構造）

抽出した情報を事実ベースで整理する

重要: タスクとMTG・イベントは重複を排除してユニークなリストにする

1. 案件別の実績 - {PROJECT_A}、{PROJECT_B}、{PROJECT_C}別に完了したタスクと成果を列挙
    - 同じタスク名が複数の日に登場しても、1回だけ表示する
2. 目標達成状況（KPT形式） - {GOAL_1}、{GOAL_2}、{GOAL_3}の各目標について
    - Keep: うまくいったこと、効果的だった取り組み、継続すべきこと
    - Problem: 課題、問題点、うまくいかなかったこと、障壁
    - Try: 来月試すこと、改善策、新しく取り組むこと
3. 数値による実績
    - 総タスク数: すべてのユニークなタスク（完了、進行中、未着手、レビュー中、中止を含む）を重複排除してカウント
    - 完了タスク数: [x]マークがついたユニークなタスクをカウント
    - 完了率: 完了タスク数 ÷ 総タスク数 × 100（小数点第1位まで）
    - MTG・イベント参加数: [x]マークがつき、キーワード条件を満たすユニークなイベントをカウント
    - デイリーノート記録日数: 対象期間内に存在するデイリーノートの日数をカウント
    - 重要: すべての数値は正確にカウントすること。推測や概算は絶対に記載しないこと

### ステップ4: レビューファイルの作成

`02_Monthly/YYYYMM_review.md`にファイルを生成する

以下のテンプレート構造を使用し、実際のデータとインサイトを入力する

レビューテンプレート

```markdown
# 月次振り返り（KPT） - [期間表示]

## 対象期間

- [START_DATE] 〜 [END_DATE]

## 案件別の実績

### {PROJECT_A}

- 完了したタスク
    - [x] [具体的なタスク内容]
    - [x] [具体的なタスク内容]
- 参加したMTG・イベント
    - [日付] [MTG名]

### {PROJECT_B}

- 完了したタスク
    - [x] [具体的なタスク内容]
- 参加したMTG・イベント
    - [日付] [MTG名]

### {PROJECT_C}

- 完了したタスク
    - [x] [具体的なタスク内容]
- 参加したMTG・イベント
    - [日付] [MTG名]

### その他（ブログ・その他）

- 完了したタスク
    - [x] [具体的なタスク内容]

## 目標達成状況（KPT形式）

### {GOAL_1}

- Keep（継続すべきこと）
    - [うまくいったこと、効果的だった取り組み]
    - [関連する完了タスクやMTG参加]
- Problem（課題・問題点）
    - [うまくいかなかったこと、障壁になったこと]
    - [未達成のタスクや発生した問題]
- Try（来月試すこと）
    - [改善策、新しく取り組むこと]
    - [具体的なアクションプラン]

### {GOAL_2}

- Keep（継続すべきこと）
    - [うまくいったこと、効果的だった取り組み]
    - [関連する完了タスクやMTG参加]
- Problem（課題・問題点）
    - [うまくいかなかったこと、障壁になったこと]
    - [未達成のタスクや発生した問題]
- Try（来月試すこと）
    - [改善策、新しく取り組むこと]
    - [具体的なアクションプラン]

### {GOAL_3}

- Keep（継続すべきこと）
    - [うまくいったこと、効果的だった取り組み]
    - [関連する完了タスクやMTG参加]
- Problem（課題・問題点）
    - [うまくいかなかったこと、障壁になったこと]
    - [未達成のタスクや発生した問題]
- Try（来月試すこと）
    - [改善策、新しく取り組むこと]
    - [具体的なアクションプラン]

## 定量的な実績

- 総タスク数: XX件（すべてのユニークなタスク）
- 完了タスク数: XX件
- 完了率: XX.X%
- MTG・イベント参加数: XX件
- デイリーノート記録日数: XX日
```

すべてのステップを実行し、ただちにファイルを作成すること。

以下を含むKPT形式の振り返りファイルを作成する

1. 適切な日付計算と範囲決定
2. 範囲内のすべてのデイリーノートからの体系的な抽出
3. 案件別の完了タスクとMTG参加の記録（重複を排除したユニークなリスト）
4. 目標ごとのKPT分析
    - Keep: デイリーノートの振り返りから、うまくいったこと、効果的だった取り組みを抽出
    - Problem: 課題、問題点、うまくいかなかったことを抽出
    - Try: 来月試すこと、改善策、新しく取り組むことを提案
5. 定量的な実績（タスク数、完了率、MTG数など）

重要な注意事項

- 主観的な評価や推測は避け、デイリーノートから抽出できる事実のみを記載すること
- タスクは重複を排除し、同じタスク名は1回のみ表示すること
- MTG・イベントは「定例」「MTG」「会議」「1on1」「○○会」などのキーワードを含むもののみを抽出すること
- 作業時間ブロック（括弧で始まるプロジェクト作業）は除外すること
- KPTの各要素はデイリーノートの振り返りセクションから具体的な内容を抽出して記載すること
- 定量的な実績の数値は、すべて正確にカウントすること。推測や概算は絶対に記載しないこと
- 総タスク数は、すべてのステータス（完了、進行中、未着手、レビュー中、中止）のユニークなタスクをカウントすること

最終ファイルを`02_Monthly/`ディレクトリに保存すること。
